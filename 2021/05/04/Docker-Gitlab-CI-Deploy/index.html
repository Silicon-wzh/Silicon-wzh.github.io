<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    Docker&amp;Gitlab-CI Deploy |  HUI&#39;s Blog
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/css/style.css">

  
<script src="/js/pace.min.js"></script>


  

  

</head>

</html>

<body>
  <div id="app">
    <main class="content">
      <section class="outer">
  <article id="post-Docker-Gitlab-CI-Deploy" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Docker&amp;Gitlab-CI Deploy
</h1>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2021/05/04/Docker-Gitlab-CI-Deploy/" class="article-date">
  <time datetime="2021-05-04T14:31:39.000Z" itemprop="datePublished">2021-05-04</time>
</a>
      
      
      
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> å­—æ•°ç»Ÿè®¡:</span>
            <span class="post-count">4.6kå­—</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> é˜…è¯»æ—¶é•¿â‰ˆ</span>
            <span class="post-count">18åˆ†é’Ÿ</span>
        </span>
    </span>
</div>

      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    
    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h3 id="Docker-amp-Gitlab-CI"><a href="#Docker-amp-Gitlab-CI" class="headerlink" title="Docker &amp; Gitlab CI"></a>Docker &amp; Gitlab CI</h3><a id="more"></a>
<h5 id="1-Docker-basic-command-list"><a href="#1-Docker-basic-command-list" class="headerlink" title="1. Docker basic command list"></a>1. Docker basic command list</h5><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ docker pull (image) (tag)            &#x2F;&#x2F;ä»å®˜æ–¹æºæ‹‰å–é•œåƒ</span><br><span class="line">$ docker images &#x3D; docker image ls     &#x2F;&#x2F;æ˜¾ç¤ºé•œåƒåˆ—è¡¨</span><br><span class="line">$ docker ps                             &#x2F;&#x2F;æ˜¾ç¤ºdockerè¿›ç¨‹</span><br><span class="line">$ docker container ls</span><br><span class="line">$ docker start CONTAINER_ID</span><br><span class="line">$ docker system df                     &#x2F;&#x2F;æ˜¾ç¤ºå†…å­˜ä¿¡æ¯</span><br><span class="line">$ docker stop CONTAINER_NAME         &#x2F;&#x2F;å…³é—­container</span><br><span class="line">$ docker restart CONTAINER_NAME         &#x2F;&#x2F;é‡å¯container</span><br><span class="line">$ docker run img:tag </span><br><span class="line">OPTION:</span><br><span class="line">-a stdin: æŒ‡å®šæ ‡å‡†è¾“å…¥è¾“å‡ºå†…å®¹ç±»å‹ï¼Œå¯é€‰ STDIN&#x2F;STDOUT&#x2F;STDERR ä¸‰é¡¹ï¼›</span><br><span class="line">-d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼›</span><br><span class="line">-rm: é€€å‡ºæ—¶è‡ªåŠ¨æ¸…ç†å®¹å™¨å†…éƒ¨çš„æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">-i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›</span><br><span class="line">-P: éšæœºç«¯å£æ˜ å°„ï¼Œå®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„ç«¯å£</span><br><span class="line">-p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£</span><br><span class="line">-t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›</span><br><span class="line">--name&#x3D;&quot;nginx-lb&quot;: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›</span><br><span class="line">--dns 8.8.8.8: æŒ‡å®šå®¹å™¨ä½¿ç”¨çš„DNSæœåŠ¡å™¨ï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›</span><br><span class="line">--dns-search example.com: æŒ‡å®šå®¹å™¨DNSæœç´¢åŸŸåï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›</span><br><span class="line">-h &quot;mars&quot;: æŒ‡å®šå®¹å™¨çš„hostnameï¼›</span><br><span class="line">-e username&#x3D;&quot;ritchie&quot;: è®¾ç½®ç¯å¢ƒå˜é‡ï¼›</span><br><span class="line">--env-file&#x3D;[]: ä»æŒ‡å®šæ–‡ä»¶è¯»å…¥ç¯å¢ƒå˜é‡ï¼›</span><br><span class="line">--cpuset&#x3D;&quot;0-2&quot; or --cpuset&#x3D;&quot;0,1,2&quot;: ç»‘å®šå®¹å™¨åˆ°æŒ‡å®šCPUè¿è¡Œï¼›</span><br><span class="line">-m :è®¾ç½®å®¹å™¨ä½¿ç”¨å†…å­˜æœ€å¤§å€¼ï¼›</span><br><span class="line">--net&#x3D;&quot;bridge&quot;: æŒ‡å®šå®¹å™¨çš„ç½‘ç»œè¿æ¥ç±»å‹ï¼Œæ”¯æŒ bridge&#x2F;host&#x2F;none&#x2F;container:å››ç§ç±»å‹ï¼›</span><br><span class="line">--link&#x3D;[]: æ·»åŠ é“¾æ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼›</span><br><span class="line">--expose&#x3D;[]: å¼€æ”¾ä¸€ä¸ªç«¯å£æˆ–ä¸€ç»„ç«¯å£ï¼›</span><br><span class="line">--volume , -v: ç»‘å®šä¸€ä¸ªå·</span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="2-Deploy-GitLab-Runner"><a href="#2-Deploy-GitLab-Runner" class="headerlink" title="2. Deploy GitLab Runner"></a>2. Deploy GitLab Runner</h5><ul>
<li><strong>Install</strong></li>
</ul>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d --name gitlab-runner --restart always \ </span><br><span class="line">				  -v &#x2F;srv&#x2F;gitlab-runer&#x2F;config:&#x2F;etc&#x2F;gitlab-runer \</span><br><span class="line">			  -v &#x2F;var&#x2F;run&#x2F;docker.sock:&#x2F;var&#x2F;run&#x2F;docker.sock \</span><br><span class="line">			  gitlab&#x2F;gitlab-runner:latest</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><strong>Regist GitLab Runer</strong></li>
</ul>
<p><img src="/images/pasted-72.png" alt="upload successful"></p>
<blockquote>
<p><strong>Get Token Here</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm -v &#x2F;srv&#x2F;gitlab-runner&#x2F;config:&#x2F;etc&#x2F;gitlab-runner gitlab&#x2F;gitlab-runner register \</span><br><span class="line">--non-interactive \</span><br><span class="line">--executor &quot;docker&quot; \</span><br><span class="line">  --docker-image alpine:latest \</span><br><span class="line">--url &quot;$gitlab address&quot; \</span><br><span class="line">--registration-token &quot;$TOKEN&quot; \</span><br><span class="line">--description &quot;first-register-runner&quot; \</span><br><span class="line">--tag-list &quot;test-cicd, dockercicd&quot; \ (runner æ ‡ç­¾)</span><br><span class="line">--run-untagged&#x3D;&quot;true&quot; \</span><br><span class="line">--locked&#x3D;&quot;false&quot; \</span><br><span class="line">--access-level&#x3D;&quot;not_protected&quot;</span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="3-yml-file"><a href="#3-yml-file" class="headerlink" title="3. yml file"></a>3. yml file</h5><ul>
<li>åŸºæœ¬å…³é”®è¯<blockquote>
<p>ä»»åŠ¡å…³é”®è¯:<br><code>script</code>,<code>after_script</code>,<code>allow_failure</code>,<code>artifacts</code>,<code>before_script</code>,<code>cache</code>,<code>coverage</code>,<code>dependencies</code>,<code>environment</code>,<code>except</code>,<code>extends</code>,<code>image</code>,<code>include</code>,<code>interruptible</code>,<code>only</code>,<code>pages</code>,<code>parallel</code>,<code>release</code>,<code>resource_group</code>,<code>retry</code>,<code>rules</code>,<code>services</code>,<code>stage</code>,<code>tags</code>,<code>timeout</code>,<code>trigger</code>,<code>variables</code>,<code>when</code><br>å…¨å±€å…³é”®è¯<br><code>image</code>,<code>services</code>,<code>before_script</code>,<code>after_script</code>,<code>tags</code>,<code>cache</code>,<code>artifacts</code>,<code>retry</code>,<code>timeout</code>,<code>interruptible</code></p>
</blockquote>
</li>
</ul>
<p><strong>script</strong><br>ä»»åŠ¡è¦æ‰§è¡Œçš„shellè„šæœ¬å†…å®¹ï¼Œå†…å®¹ä¼šè¢«runneræ‰§è¡Œï¼Œåœ¨è¿™é‡Œï¼Œä½ ä¸éœ€è¦ä½¿ç”¨git clone â€¦.å…‹éš†å½“å‰çš„é¡¹ç›®ï¼Œæ¥è¿›è¡Œæ“ä½œï¼Œå› ä¸ºåœ¨æµæ°´çº¿ä¸­ï¼Œæ¯ä¸€ä¸ªçš„jobçš„æ‰§è¡Œéƒ½ä¼šå°†é¡¹ç›®ä¸‹è½½ï¼Œæ¢å¤ç¼“å­˜è¿™äº›æµç¨‹ï¼Œä¸éœ€è¦ä½ å†ä½¿ç”¨è„šæœ¬æ¢å¤ã€‚ä½ åªéœ€è¦åœ¨è¿™é‡Œå†™ä½ çš„é¡¹ç›®å®‰è£…ï¼Œç¼–è¯‘æ‰§è¡Œï¼Œå¦‚<br>npm install å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè„šæœ¬çš„å·¥ä½œç›®å½•å°±æ˜¯å½“å‰é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ‰€æœ‰å¯ä»¥å°±åƒåœ¨æœ¬åœ°å¼€å‘ä¸€æ ·ã€‚æ­¤å¤–scriptå¯ä»¥æ˜¯å•è¡Œæˆ–è€…å¤šè¡Œ</p>
<p>å•è¡Œè„šæœ¬</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">script:</span> <span class="string">npm</span> <span class="string">install</span></span><br></pre></td></tr></table></figure>
<p>å¤šè¡Œè„šæœ¬<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">job:</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">config</span> <span class="string">set</span> <span class="string">sass_binary_site</span> <span class="string">https://npm.taobao.org/mirrors/node-sass/</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">--registry=http://registry.npm.taobao.org</span></span><br></pre></td></tr></table></figure></p>
<p><code>script</code>æ˜¯ä¸€ä¸ªjobçš„å¿…å¡«å†…å®¹ï¼Œä¸å¯æˆ–ç¼ºã€‚ä¸€ä¸ªjobæœ€å°‘æœ‰äºŒä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯job nameï¼Œ ä»»åŠ¡åç§°ï¼Œ ä¸€ä¸ªå°±æ˜¯scriptã€‚</p>
<p><strong>image</strong><br>æŒ‡å®šä¸€ä¸ªåŸºç¡€Dockeré•œåƒä½œä¸ºåŸºç¡€è¿è¡Œç¯å¢ƒï¼Œç»å¸¸ç”¨åˆ°çš„é•œåƒæœ‰node nginx docker</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">job:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">node:latest</span></span><br><span class="line">  <span class="attr">script:</span> <span class="string">npm</span> <span class="string">install</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢è¿™ä¸ªä»»åŠ¡ä¸­ï¼Œå¦‚æœä¸æŒ‡å®šimage: node:latest æ‰§è¡Œä¸‹é¢çš„npm installæ—¶ä¼šæŠ¥é”™ï¼Œæ‰¾ä¸åˆ°npmçš„å‘½ä»¤ã€‚<br>imageçš„ä½œç”¨å°±æ˜¯ç»™å½“å‰ä»»åŠ¡æˆ–è€…å½“å‰æµæ°´çº¿è®¾ç½®ä¸€ä¸ªåŸºç¡€ç¯å¢ƒï¼Œæœ‰å¯èƒ½æ˜¯nodejsï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯javaï¼Œ goï¼Œ phpï¼Œ<br>å¯ä»¥è®¾ç½®å½“å‰æµæ°´çº¿çš„ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å½“å‰ä»»åŠ¡çš„ã€‚</p>
<p><strong>artifacts</strong><br>ç¿»è¯‘å‡ºæ¥è¿™ä¸ªå•è¯å°±æ˜¯åˆ¶å“ï¼Œä¸€ä¸ªæˆå“ï¼Œä½œç”¨æ˜¯å°†æµæ°´çº¿è¿‡ç¨‹ä¸­çš„ä¸€äº›æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹ï¼Œæ‰“åŒ…å‹ç¼©ï¼Œæä¾›ä¸€ä¸ªå¤–é“¾ä¾›äººä¸‹è½½ï¼Œå¦å¤–è¿˜èƒ½åœ¨åç»­çš„jobä¸­ç¼“å­˜ã€‚<br>æ¯”å¦‚æˆ‘ä»¬æ„å»ºä¸€ä¸ªå‰ç«¯é¡¹ç›®åå°†distç›®å½•åšæˆä¸€ä¸ªå‹ç¼©åŒ…ï¼Œ</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line">        <span class="attr">artifacts:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">dist/</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä»»åŠ¡åé¢è¿è¡Œçš„ä»»åŠ¡ä¼šè‡ªåŠ¨æ¢å¤è¿™ä¸ªåˆ¶å“ï¼Œæ„å‘³ç€ä½ ä¸ç”¨å†æ‰§è¡Œ<code>`npm run build</code>æ¥è·å–ç¼–è¯‘åçš„<code>dist</code>æ–‡ä»¶äº†ï¼Œ<br>åœ¨å®‰å“ï¼Œiosæ‰“åŒ…çš„æ—¶å€™ï¼Œéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæµæ°´çº¿æœ€ç»ˆè¾“å‡ºçš„å°±æ˜¯ä¸€ä¸ªå¯ä¸‹è½½ï¼Œå¯å®‰è£…çš„åº”ç”¨ã€‚<br>paths æ˜¯ç”¨æ¥æŒ‡å®šå°†é‚£äº›æ–‡ä»¶ï¼Œç›®å½•æ”¾å…¥åˆ¶å“ä¸­ï¼Œ<br>ä¹Ÿå¯ä»¥ä½¿ç”¨excludeå…³é”®è¯ï¼Œå°†é‚£äº›ç›®å½•ï¼Œæ–‡ä»¶æ’é™¤ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚<br>æ­¤å¤–è¿˜æœ‰ä»¥ä¸‹å‡ ä¸ªå±æ€§</p>
<ul>
<li>paths æ–‡ä»¶è·¯å¾„</li>
<li>exclude æ’é™¤çš„æ–‡ä»¶</li>
<li>name artifacåç§°</li>
<li>expose_as åœ¨UIé¡µé¢å¯¼å‡ºçš„åç§°</li>
<li>untracked å¸ƒå°”ç±»å‹ï¼Œæ˜¯å¦å°†gitå¿½ç•¥çš„æ–‡ä»¶åŠ åˆ°artifactä¸­</li>
<li>when on_successï¼›on_failureï¼›always ä½•æ—¶ä¸Šä¼ artifact</li>
<li>expire_in è¿‡æœŸæ—¶é—´é»˜è®¤30å¤©</li>
<li>reports æ”¶é›†æµ‹è¯•æŠ¥å‘Š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">build:</span><br><span class="line">  script:</span><br><span class="line">    - npm run build</span><br><span class="line">  artifacts:</span><br><span class="line">    paths:</span><br><span class="line">      - dist&#x2F;</span><br><span class="line">    exclude:</span><br><span class="line">      - binaries&#x2F;**&#x2F;*.o</span><br><span class="line">    expose_as: &#39;artifact 1&#39;</span><br><span class="line">    name: &quot;$CI_COMMIT_REF_NAME&quot;</span><br><span class="line">    untracked: false</span><br><span class="line">    expire_in: 2 hrs 20 min</span><br><span class="line">    when: on_failure</span><br></pre></td></tr></table></figure>
<p><strong>tags</strong><br>    tags å…³é”®è¯æ˜¯ç”¨äºæŒ‡å®šRunner,tagsçš„å–å€¼èŒƒå›´æ˜¯åœ¨è¯¥é¡¹ç›®å¯è§çš„runner tagsä¸­ï¼Œå¯ä»¥åœ¨Setting =&gt;CI/CD =&gt; Runner ä¸­æŸ¥çœ‹çš„åˆ°ã€‚<br>    è¦çŸ¥é“ï¼Œæ”¹å±æ€§å¯ä»¥è®¾ç½®å…¨å±€ï¼Œä¸è®¾ç½®åˆ™é»˜è®¤ä½¿ç”¨å…¬æœ‰Runnerå»æ‰§è¡Œæµæ°´çº¿ã€‚æ¯ä¸ªä»»åŠ¡å¯ä»¥æŒ‡å®šä¸€ä¸ªRunnerï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªæ ‡ç­¾ï¼Œä½†runnerå´åªèƒ½ä¸€ä¸ªã€‚ä»¥ä¸€ä¸ªä¸ºå‡†ã€‚tagsæ˜¯åœ¨æˆ‘ä»¬æ³¨å†ŒRunneræ˜¯é…ç½®çš„,åç»­ä¹Ÿå¯ä»¥æ›´æ”¹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">install:</span><br><span class="line">  tags:</span><br><span class="line">    - hello-vue</span><br><span class="line">        - docker</span><br><span class="line">    script:</span><br><span class="line">        - npm config set sass_binary_site https:&#x2F;&#x2F;npm.taobao.org&#x2F;mirrors&#x2F;node-sass&#x2F;</span><br><span class="line">        - npm install --registry&#x3D;http:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure><br><strong>cache</strong><br>ç¼“å­˜æ˜¯å°†å½“å‰å·¥ä½œç¯å¢ƒç›®å½•ä¸­çš„ä¸€äº›æ–‡ä»¶ï¼Œä¸€äº›æ–‡ä»¶å¤¹å­˜å‚¨èµ·æ¥ï¼Œç”¨äºåœ¨å„ä¸ªä»»åŠ¡åˆå§‹åŒ–çš„æ—¶å€™æ¢å¤ã€‚é¿å…å¤šä¸ªä¸‹è½½åŒæ ·çš„åŒ…ï¼Œèƒ½å¤Ÿå¤§å¤§ä¼˜åŒ–æµæ°´çº¿æ•ˆç‡ã€‚åœ¨å‰ç«¯é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸æŠŠnode_modulesç¼“å­˜èµ·æ¥ï¼Œè¿™æ ·ä¸€æ¡æµæ°´çº¿éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›ä¸‹è½½å¥½çš„åŒ…ã€‚åœ¨javaé¡¹ç›®ä¸­ç»å¸¸æŠŠmavenä¸‹è½½çš„åŒ…ç¼“å­˜èµ·æ¥ã€‚ä»¥å¤‡åç”¨<br>cacheä¸‹çš„å‚æ•°æœ‰</p>
<ul>
<li>paths å½“å‰å·¥ä½œç¯å¢ƒä¸‹çš„ç›®å½•</li>
<li>key å­˜å‚¨çš„keyï¼Œkeyä¸å˜ä¸ä¼šé‡æ–°ç”Ÿæˆç¼“å­˜ï¼Œ</li>
<li>ğŸ”‘prefix ä½¿ç”¨ä¸€äº›æ–‡ä»¶åˆ¶ä½œæˆæ–‡ä»¶hashå€¼ï¼Œå½“åškeyçš„ä¸€éƒ¨åˆ†ï¼Œ</li>
<li>untracked æ˜¯å¦ç¼“å­˜gitå¿½ç•¥çš„æ–‡ä»¶</li>
<li>when å®šä¹‰ä½•æ—¶å­˜å‚¨ç¼“å­˜ on_successï¼›on_failureï¼›always</li>
<li>policy ç¼“å­˜æ˜¯å¦è¦åœ¨jobå®Œæˆåé‡æ–°ä¸Šä¼ <br>ç¼“å­˜å¯ä»¥è®¾ç½®æµæ°´çº¿å…¨å±€ï¼Œä¹Ÿå¯ä»¥åœ¨jobä¸­è®¾ç½®</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cache:</span><br><span class="line">  key: hello-vue-cache</span><br><span class="line">  paths:</span><br><span class="line">    - node_modules</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cache:</span><br><span class="line">  key:</span><br><span class="line">    files:</span><br><span class="line">      - Gemfile.lock</span><br><span class="line">      - package.json</span><br><span class="line">  paths:</span><br><span class="line">    - vendor&#x2F;ruby</span><br><span class="line">    - node_modules</span><br></pre></td></tr></table></figure>
<p><strong>stage</strong></p>
<p>stage æ˜¯é˜¶æ®µçš„æ„æ€ï¼Œç”¨äºå½’æ¡£ä¸€éƒ¨åˆ†çš„jobï¼ŒæŒ‰ç…§å®šä¹‰çš„stageé¡ºåºæ¥æ‰§è¡Œã€‚<br>é»˜è®¤çš„stageæœ‰buildï¼Œtestï¼Œdeployï¼Œ æ­¤å¤–è¿˜æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„.pre å’Œ .post<br>jobæ‰§è¡Œçš„é¡ºåºä¸æ˜¯æŒ‰ç…§ç¼–å†™çš„é¡ºåºï¼Œå¤§ä½“ä¸Šæ˜¯æŒ‰ç…§stageå®šä¹‰çš„é¡ºåºæ¥æ‰§è¡Œçš„,æ³¨æ„æ˜¯å¤§ä½“ï¼Œä¹Ÿæœ‰ä¾‹å¤–çš„æƒ…å†µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">stages:</span><br><span class="line">  - build</span><br><span class="line">  - test</span><br><span class="line">  - deploy</span><br><span class="line"></span><br><span class="line">job 0:</span><br><span class="line">  stage: test</span><br><span class="line">  script: echo &#39;tets&#39;</span><br><span class="line"></span><br><span class="line">job 1:</span><br><span class="line">  stage: build</span><br><span class="line">  script: echo &#39;build&#39;</span><br></pre></td></tr></table></figure>
<p>ç”±äºbuildåœ¨testä¹‹å‰æ‰€æœ‰ä¼šæŒ‡å‘job1è¿™ä¸ªä»»åŠ¡ï¼ŒåæŒ‡å‘job0ä»»åŠ¡</p>
<p><strong>when</strong></p>
<ul>
<li><p>whenå…³é”®å­—æ˜¯å®ç°åœ¨å‘ç”Ÿæ•…éšœæˆ–å°½ç®¡å‘ç”Ÿæ•…éšœæ—¶ä»èƒ½è¿è¡Œçš„ä½œä¸šã€‚æ¯”å¦‚ä½ è¦åœ¨ä»»åŠ¡å¤±è´¥åéœ€è¦è§¦å‘ä¸€ä¸ªjobï¼Œ<br>æˆ–è€…ä½ éœ€è¦æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡ï¼Œæˆ–è€…å½“ä½ ä¸€ä¸ªä»»åŠ¡æ‰§è¡ŒæˆåŠŸåï¼Œæ‰§è¡Œå¦ä¸€ä¸ªä»»åŠ¡.</p>
</li>
<li><p>on_success æ‰€æœ‰ä»»åŠ¡æ‰§è¡ŒæˆåŠŸå</p>
</li>
<li>on_failure å½“è‡³å°‘ä¸€ä¸ªä»»åŠ¡å¤±è´¥å</li>
<li>always æ‰§è¡Œä½œä¸šï¼Œè€Œä¸è€ƒè™‘ä½œä¸šåœ¨æ—©æœŸé˜¶æ®µçš„çŠ¶æ€ã€‚</li>
<li>manual æ‰‹åŠ¨æ‰§è¡Œä»»åŠ¡</li>
<li>delayed å»¶è¿Ÿæ‰§è¡Œä»»åŠ¡</li>
<li>never<br>åœ¨rulesä¸­ä¸æ’é™¤æ‰§è¡Œçš„ä»»åŠ¡<br>åœ¨workflow:rulesä¸å…è®¸çš„æµæ°´çº¿</li>
</ul>
<p><strong>only/except</strong></p>
<p>only/except æ˜¯è§„å®šå½“å‰jobçš„å¯è§çŠ¶æ€ï¼Œä¸€ä¸ªé¡¹ç›®æœ‰å¾ˆå¤šåˆ†æ”¯ï¼Œtagï¼Œæˆ‘ä»¬çš„æµæ°´çº¿ï¼Œä¸ºäº†å¯¹ç‰¹å®šçš„åˆ†æ”¯ï¼Œç‰¹å®šçš„tagæ‰§è¡Œä¸åŒçš„jobï¼Œè¿™é‡Œå°±è¦ä½¿ç”¨onlyå’Œexcept<br>åœ¨ä»»åŠ¡ä¸ŠåŠ ä¸Šè¿™ä¸€æ®µä»£ç ï¼Œå°±è¡¨æ˜å½“å‰ä»»åŠ¡åªæœ‰åœ¨masteråˆ†æ”¯å¯ä»¥è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">only:</span><br><span class="line">  - master</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥æ ¹æ®å½“å‰çš„ä»£ç å˜åŠ¨æ˜¯åˆå¹¶ï¼Œè¿˜æ˜¯æ¨é€ï¼Œè¿˜æ˜¯ä½¿ç”¨APIæ¥è§¦å‘çš„ã€‚<br>    å¦‚æœä¸€ä¸ªä»»åŠ¡æ²¡æœ‰onlyå±æ€§ï¼Œé‚£é»˜è®¤å°±æ˜¯<br>    only: [â€˜branchesâ€™, â€˜tagsâ€™] æ“ä½œåˆ†æ”¯æˆ–è€…tagséƒ½ä¼šè§¦å‘æµæ°´çº¿ã€‚</p>
<p><strong>before_script</strong><br>before_script å…³é”®è¯æ˜¯ç”¨äºåœ¨æ¯ä¸ªä»»åŠ¡ä¹‹å‰æ‰§è¡Œçš„è„šæœ¬ï¼Œä½†æ˜¯ä¼šåœ¨artifactsæ¢å¤ä¹‹åæ‰§è¡Œã€‚ä½ å¯ä»¥è¿™æ ·å®šä¹‰ä¸€ä¸ªå…¨å±€çš„before_scriptï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">default:</span><br><span class="line">  before_script:</span><br><span class="line">    - echo &quot;Execute this script in all jobs that don&#39;t already have a before_script section.&quot;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªä»»åŠ¡ä¸­ä¸­å•ç‹¬å®šä¹‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">job:</span><br><span class="line">  before_script:</span><br><span class="line">    - echo &quot;Execute this script instead of the global before_script.&quot;</span><br><span class="line">    script:</span><br><span class="line">        - echo &quot;This script executes after the job&#39;s &#96;before_script&#96;&quot;</span><br></pre></td></tr></table></figure><br>ä»»åŠ¡ä¸­çš„before_scriptä¼šè¦†ç›–å…¨å±€çš„before_script</p>
<p><strong>after_script</strong><br>after_scriptä¸before_scriptç±»ä¼¼ï¼Œç”¨äºå®šä¹‰å¤šè¡Œè„šæœ¬ï¼Œä¼šåœ¨ä»»åŠ¡æ‰§è¡Œå®Œæˆåæ‰§è¡Œï¼Œå³ä½¿ä»»åŠ¡å¤±è´¥ä¹Ÿä¼šè¢«æ‰§è¡Œã€‚å¦‚æœä»»åŠ¡è¢«å–æ¶ˆæˆ–è€…è¶…æ—¶ï¼Œafter_scriptå°±ä¸ä¼šè¢«æ‰§è¡Œäº†ï¼Œç›®å‰å®˜æ–¹æ­£åœ¨è®¡åˆ’è¿™ä¸ªç‰¹æ€§ã€‚<br>å¯ä»¥å®šä¹‰å…¨å±€çš„ï¼Œä¹Ÿå¯ä»¥å®šä¹‰å±€éƒ¨çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">default:</span><br><span class="line">  after_script:</span><br><span class="line">    - echo &quot;Execute this script in all jobs that don&#39;t already have an after_script section.&quot;</span><br><span class="line"></span><br><span class="line">job1:</span><br><span class="line">  script:</span><br><span class="line">    - echo &quot;This script executes first. When it completes, the global after_script executes.&quot;</span><br><span class="line"></span><br><span class="line">job:</span><br><span class="line">  script:</span><br><span class="line">    - echo &quot;This script executes first. When it completes, the job&#39;s &#96;after_script&#96; executes.&quot;</span><br><span class="line">  after_script:</span><br><span class="line">    - echo &quot;Execute this script instead of the global after_script.&quot;</span><br></pre></td></tr></table></figure>
<p><strong>dependencies</strong><br>dependencieså…³é”®è¯æ˜¯å®šä¹‰ç‰¹å®šçš„jobè¿è¡Œè§„åˆ™ã€‚é»˜è®¤artifactsæ˜¯ä»å½“å‰é˜¶æ®µäº§ç”Ÿï¼Œåœ¨åç»­çš„é˜¶æ®µéƒ½ä¼šè¢«ä¸‹è½½ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨dependencieså…³é”®è¯æ¥æ§åˆ¶artifactsä»å“ªé‡Œä¸‹è½½ï¼Œ<br>è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">build:osx:</span><br><span class="line">  stage: build</span><br><span class="line">  script: make build:osx</span><br><span class="line">  artifacts:</span><br><span class="line">    paths:</span><br><span class="line">      - binaries&#x2F;</span><br><span class="line"></span><br><span class="line">build:linux:</span><br><span class="line">  stage: build</span><br><span class="line">  script: make build:linux</span><br><span class="line">  artifacts:</span><br><span class="line">    paths:</span><br><span class="line">      - binaries&#x2F;</span><br><span class="line"></span><br><span class="line">test:osx:</span><br><span class="line">  stage: test</span><br><span class="line">  script: make test:osx</span><br><span class="line">  dependencies:</span><br><span class="line">    - build:osx</span><br><span class="line"></span><br><span class="line">test:linux:</span><br><span class="line">  stage: test</span><br><span class="line">  script: make test:linux</span><br><span class="line">  dependencies:</span><br><span class="line">    - build:linux</span><br><span class="line"></span><br><span class="line">deploy:</span><br><span class="line">  stage: deploy</span><br><span class="line">  script: make deploy</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®è¿™ä¸ªä¾‹å­æˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼Œ<br>ä»»åŠ¡test:osx ä¾èµ–build:osx<br>ä»»åŠ¡test:linux ä¾èµ– build:linux<br>è¿™æ ·é…ç½®ä»¥å ä»»åŠ¡test:linux å°±ä¸ç”¨ç­‰ä»»åŠ¡build:osx æ‰§è¡Œå®Œæˆåœ¨æ‰§è¡Œäº†ï¼Œåªéœ€è¦ç­‰å¾…ä»»åŠ¡build:linuxå®Œæˆ<br>å¾ˆå¥½åœ°åˆ©ç”¨äº†ä¾èµ–å…³ç³»æ¥ä¼˜åŒ–æµæ°´çº¿çš„é€Ÿç‡ï¼Œå‰å››ä¸ªä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆåï¼Œæ‰ä¼šæ‰§è¡Œæœ€åä¸€ä¸ªéƒ¨ç½²çš„ä»»åŠ¡ã€‚</p>
<p><strong>environment</strong><br>environmentæ˜¯ç”¨äºå®šä¹‰ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥æ˜¯ç”¨k-vçš„æ–¹å¼å®šä¹‰<br>å¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy to production:</span><br><span class="line">  stage: deploy</span><br><span class="line">  script: git push production HEAD:master</span><br><span class="line">  environment:</span><br><span class="line">    name: production</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œå®šä¹‰çš„ç¯å¢ƒå˜é‡æ˜¯ä¸èƒ½åœ¨scriptå€¼ä½¿ç”¨çš„ã€‚<br>è¿™ä¸ªå…³é”®è¯å¯ä»¥å’Œreviewå’Œmergeæ­é…ã€‚</p>
<p><strong>extends</strong><br>è¿™ä¸ªå…³é”®è¯å¯ä»¥ä½¿ä¸€ä¸ªä»»åŠ¡ç»§æ‰¿å¦ä¸€ä¸ªä»»åŠ¡ã€‚<br>å¦‚ä¸‹æ¡ˆä¾‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.tests:</span><br><span class="line">  script: rake test</span><br><span class="line">  stage: test</span><br><span class="line">  only:</span><br><span class="line">    refs:</span><br><span class="line">      - branches</span><br><span class="line"></span><br><span class="line">rspec:</span><br><span class="line">  extends: .tests</span><br><span class="line">  script: rake rspec</span><br><span class="line">  only:</span><br><span class="line">    variables:</span><br><span class="line">      - $RSPEC</span><br></pre></td></tr></table></figure>
<p>ä»»åŠ¡rspec ç»§æ‰¿äº†.testsä»»åŠ¡ï¼Œåœ¨æµæ°´çº¿ä¸­.testsæ˜¯ä¸€ä¸ªéšè—çš„ä»»åŠ¡ï¼Œåœ¨æµæ°´çº¿ä¸­ï¼Œä»¥è‹±æ–‡è¿œç‚¹å¼€å¤´çš„ä»»åŠ¡åï¼Œéƒ½æ˜¯éšè—çš„ä»»åŠ¡ã€‚ä¸ä¼šè¢«æ‰§è¡Œã€‚ è¢«rspecç»§æ‰¿åï¼Œç›¸åŒçš„keyä¼šä»¥rspecä¸ºå‡†ï¼Œrspecæ²¡æœ‰çš„ï¼Œè€Œ.testsæœ‰çš„ï¼Œåˆ™åˆå¹¶åˆ°rspecä¸­ï¼Œ<br>åˆå¹¶åçš„ç»“æœæ˜¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rspec:</span><br><span class="line">  script: rake rspec</span><br><span class="line">  stage: test</span><br><span class="line">  only:</span><br><span class="line">    refs:</span><br><span class="line">      - branches</span><br><span class="line">    variables:</span><br><span class="line">      - $RSPEC</span><br></pre></td></tr></table></figure><br>ä½¿ç”¨è¿™ä¸€ä¸ªæ‰‹æ®µï¼Œå¯ä»¥å†™ä¸€ä¸ªæ¨¡æ¿ï¼Œåªè¦ç¨å¾®æ”¹æ”¹å°±èƒ½åä½¿ç”¨ã€‚éå¸¸é€‚åˆå¤§æ‰¹é‡ç¼–å†™æµæ°´çº¿ã€‚</p>
<p><strong>include</strong><br>ä½¿ç”¨includeå¯ä»¥å¯¼å…¥ä¸€ä¸ªæˆ–å¤šä¸ªé¢å¤–çš„yamlæ–‡ä»¶åˆ°ä½ çš„CICDé…ç½®é‡Œï¼Œè¿™ä¸€ä½ å°±å¯ä»¥å°†ä¸€ä¸ªå¾ˆé•¿çš„æµæ°´çº¿ï¼Œåˆ†éš”å‡ºæ¥ã€‚ä½¿ç”¨includeæ¥å¼•å…¥ã€‚<br>ä¹Ÿå¯ä»¥å°†å‡ ä¸ªæµæ°´çº¿ä¸­ç›¸åŒçš„é…ç½®ï¼Œæå–å‡ºæ¥ï¼Œå…¬ç”¨ã€‚å¼•å…¥çš„æ–‡ä»¶æ‰©å±•å å¿…é¡»æ˜¯.yamlæˆ–è€….ymlä¸¤ç§ï¼Œå…¶ä»–çš„ä¸è¡Œã€‚<br>include å…³é”®è¯ä¸‹ï¼Œæœ‰å››ä¸ªå¯é€‰æ€§ï¼Œ<br>local, å¼•å…¥ä¸€ä¸ªå½“å‰é¡¹ç›®çš„æ–‡ä»¶<br>file, å¼•å…¥ä¸€ä¸ªä¸åŒé¡¹ç›®çš„æ–‡ä»¶<br>remote, å¼•å…¥ä¸€ä¸ªå…¬ç½‘æ–‡ä»¶ï¼Œ<br>template, å¼•å…¥ä¸€ä¸ªç”±GitLabæä¾›çš„æ¨¡æ¿</p>
<p>ä¸‹é¢æ˜¯å‡ ä¸ªä¾‹å­<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">include:</span><br><span class="line">  - local: &#39;&#x2F;templates&#x2F;.gitlab-ci-template.yml&#39;</span><br><span class="line"></span><br><span class="line">include:</span><br><span class="line">  - project: &#39;my-group&#x2F;my-project&#39;</span><br><span class="line">    file: &#39;&#x2F;templates&#x2F;.gitlab-ci-template.yml&#39;</span><br><span class="line"></span><br><span class="line">include:</span><br><span class="line">  - local: &#39;&#x2F;templates&#x2F;.gitlab-ci-template.yml&#39;</span><br><span class="line"></span><br><span class="line">include:</span><br><span class="line">  - project: &#39;my-group&#x2F;my-project&#39;</span><br><span class="line">    ref: master</span><br><span class="line">    file: &#39;&#x2F;templates&#x2F;.gitlab-ci-template.yml&#39;</span><br><span class="line"></span><br><span class="line">  - project: &#39;my-group&#x2F;my-project&#39;</span><br><span class="line">    ref: v1.0.0</span><br><span class="line">    file: &#39;&#x2F;templates&#x2F;.gitlab-ci-template.yml&#39;</span><br><span class="line"></span><br><span class="line">  - project: &#39;my-group&#x2F;my-project&#39;</span><br><span class="line">    ref: 787123b47f14b552955ca2786bc9542ae66fee5b  # Git SHA</span><br><span class="line">    file: &#39;&#x2F;templates&#x2F;.gitlab-ci-template.yml&#39;</span><br><span class="line"></span><br><span class="line">include:</span><br><span class="line">  - remote: &#39;https:&#x2F;&#x2F;gitlab.com&#x2F;awesome-project&#x2F;raw&#x2F;master&#x2F;.gitlab-ci-template.yml&#39;</span><br></pre></td></tr></table></figure><br><strong>trigger</strong><br>trigger æ˜¯åº”å¯¹é‚£äº›æ›´åŠ å¤æ‚çš„CICDæµç¨‹ï¼Œå¦‚å¤šæµæ°´çº¿ï¼Œçˆ¶å­æµæ°´çº¿<br>ä½¿ç”¨å®ƒå¯ä»¥å®šä¹‰ä¸€ä¸ªä¸‹æ¸¸çš„æµæ°´çº¿ï¼Œé…ç½®äº†triggerçš„ä»»åŠ¡æ˜¯ä¸èƒ½è·‘è„šæœ¬çš„ï¼Œå°±æ˜¯è¯´ä¸èƒ½å®šä¹‰script, before_script, å’Œ after_script.<br>é¡¹ç›®è¿™ä¸ªæ˜¯ä¸€ä¸ªå¤šé¡¹ç›®æµæ°´çº¿</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rspec:</span><br><span class="line">  stage: test</span><br><span class="line">  script: bundle exec rspec</span><br><span class="line"></span><br><span class="line">staging:</span><br><span class="line">  stage: deploy</span><br><span class="line">  trigger: my&#x2F;deployment</span><br></pre></td></tr></table></figure>
<p>æµæ°´çº¿æ‰§è¡Œå®Œtestä»»åŠ¡åå°±ä¼šå»æ‰§è¡Œmy/deploymenté¡¹ç›®çš„æµæ°´çº¿</p>
<p>é…ç½®ä¸‹æ¸¸æµæ°´çº¿å¼ä¹Ÿå¯ä»¥æ‰§è¡Œåˆ†æ”¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rspec:</span><br><span class="line">  stage: test</span><br><span class="line">  script: bundle exec rspec</span><br><span class="line"></span><br><span class="line">staging:</span><br><span class="line">  stage: deploy</span><br><span class="line">  trigger:</span><br><span class="line">    project: my&#x2F;deployment</span><br><span class="line">    branch: stablez</span><br></pre></td></tr></table></figure><br><strong>rules</strong><br>rulesæ˜¯ç”¨äºè§„å®šä»»åŠ¡çš„æ‰§è¡Œè§„åˆ™ï¼Œä½¿ç”¨ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ¥è§„èŒƒé‚£äº›ä»»åŠ¡æ‰§è¡Œï¼Œé‚£äº›ä»»åŠ¡ä¸æ‰§è¡Œ.è¿˜å¯ä»¥åœ¨ä»»åŠ¡æˆåŠŸï¼Œæˆ–è€…å¤±è´¥åï¼Œè§¦å‘å¦ä¸€ä¸ªä»»åŠ¡ã€‚<br>å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker build:</span><br><span class="line">  script: docker build -t my-image:$CI_COMMIT_REF_SLUG .</span><br><span class="line">  rules:</span><br><span class="line">    - if: &#39;$CI_COMMIT_BRANCH &#x3D;&#x3D; &quot;master&quot;&#39;</span><br><span class="line">      when: delayed</span><br><span class="line">      start_in: &#39;3 hours&#39;</span><br><span class="line">      allow_failure: true</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå½“å‰çš„åˆ†æ”¯æ˜¯masteråˆ†æ”¯åˆ™ä»»åŠ¡æ‰§è¡Œå°±å»¶è¿Ÿ3ä¸ªå°æ—¶ï¼Œå¹¶ä¸”å…è®¸å¤±è´¥ã€‚<br>rulesçš„ä¸‹é¢æœ‰æ˜¯å“ªä¸ªå¯é€‰å±æ€§</p>
<p>if ä½¿ç”¨ifè¡¨è¾¾å¼ æ·»åŠ æˆ–ç§»é™¤ä¸€ä¸ªä»»åŠ¡ï¼Œ ç±»ä¼¼ only:variables.<br>changes æ ¹æ®æŸäº›ä¸ªæ–‡ä»¶æ˜¯å¦æ”¹å˜æ¥è¿½åŠ æˆ–ç§»é™¤ä¸€äº›ä»»åŠ¡ã€‚ç±»ä¼¼ only:changes.<br>exists æ ¹æ®æ˜¯å¦å­˜åœ¨ç‰¹å®šæ–‡ä»¶æ¥è¿½åŠ æˆ–ç§»é™¤ä¸€äº›ä»»åŠ¡<br>ifä¸­å¯ä»¥ä½¿ç”¨CICDçš„æ‰€æœ‰é¢„è®¾å˜é‡ï¼Œåˆ†æ”¯ï¼Œæ¥æºï¼Œåˆå¹¶è¯·æ±‚ï¼Œcommitï¼Œpush webï¼Œscheduleç­‰ã€‚å¯ä»¥é’ˆå¯¹ä¸ç”¨çš„æƒ…æ™¯é…ç½®ä¸ç”¨çš„è§„åˆ™ã€‚<br>å†çœ‹ä¸‹è¿™ä¸ªä¾‹å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">job:</span><br><span class="line">  script: echo &quot;Hello, Rules!&quot;</span><br><span class="line">  rules:</span><br><span class="line">    - if: &#39;$CI_MERGE_REQUEST_TARGET_BRANCH_NAME &#x3D;&#x3D; &quot;master&quot;&#39;</span><br><span class="line">      when: manual</span><br><span class="line">      allow_failure: true</span><br></pre></td></tr></table></figure>
<p>è§£é‡Šèµ·æ¥å¹¶ä¸å¤æ‚ï¼Œä¸€ä¸ªåˆ¤æ–­è¯­å¥ï¼ŒäºŒå¥èµ‹å€¼è¯­å¥ã€‚å³å¦‚æœå½“å‰åˆ†æ”¯æ˜¯masterï¼Œåœ¨ä»»åŠ¡çš„æ‰§è¡Œæ–¹å¼æ”¹ä¸ºæ‰‹åŠ¨ï¼Œå¹¶ä¸”è¿è¡Œå¤±è´¥ã€‚</p>
<p><strong>allow_failure</strong><br>allow_failureæ˜¯ä¸€ä¸ªå¸ƒå°”ç±»å‹ï¼Œ trueæˆ–falseï¼Œ é»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºå½“å‰ä»»åŠ¡æ˜¯å¦å…è®¸å¤±è´¥ã€‚æœ‰è¿™æ ·ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼Œåœ¨ä½¿ç”¨eslintæ£€æŸ¥ä»£ç çš„æ—¶å€™ï¼Œå¦‚æœå›¢é˜Ÿç®¡ç†æ¾æ•£ï¼Œå¯ä»¥å°†åœ¨eslintçš„ä»»åŠ¡ä¸‹è®¾ç½®allow_failure: true,ï¼ˆå…¶å®è¿™æ ·è¿˜ä¸å¦‚å»æ‰è¿™ä¸ªä»»åŠ¡é‚£ï¼Œæ‰‹åŠ¨ç‹—å¤´ï¼‰ è¿™æ ·å³ä½¿è¿™ä¸ªä»»åŠ¡æŠ¥é”™äº†ï¼Œæµæ°´çº¿ä¹Ÿä¼šç»§ç»­å¾€ä¸‹èµ°ã€‚å¦‚æœä¸€ä¸ªä»»åŠ¡è®¾ç½®äº†allow_failure: trueï¼Œå¹¶ä¸”è¿™ä¸ªä»»åŠ¡æŠ¥é”™äº†ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šæ˜¾ç¤ºé»„è‰²è­¦å‘Šã€‚ä½†æœ‰ç§æƒ…å†µä»»åŠ¡å¤±è´¥äº†ä¹Ÿä¼šåœæ­¢çš„ï¼Œ é‚£å°±æ˜¯ä»»åŠ¡è®¾ç½®äº†when: manualï¼Œå³æ‰‹åŠ¨æ“ä½œçš„ä»»åŠ¡ã€‚æ‰‹åŠ¨å¯åŠ¨çš„ä»»åŠ¡ï¼ŒæŠ¥é”™äº†å°±ä¼šåœæ­¢ï¼Œä¸ä¼šç»§ç»­æ‰§è¡Œåç»­ä»»åŠ¡ï¼Œé™¤éåœ¨ruleè®¾ç½®æŠ¥é”™çš„å¤„ç†é€»è¾‘ã€‚</p>
<p><strong>coverage</strong><br>coverage æ˜¯ç”¨äºè·å–é¡¹ç›®çš„ä»£ç è¦†ç›–ç‡ï¼Œè¿™ä¸ªé…ç½®é¡¹çš„å€¼åªèƒ½æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå®˜æ–¹æœ‰æä¾›ä¸€äº›ï¼Œåœ¨CICDçš„General pipelinesé‡Œ<br>è¦†ç›–ç‡å¯ä»¥æ·»åŠ åˆ°é¡¹ç›®çš„readmeä¸Šï¼Œåƒè¿™æ ·çš„ã€‚</p>
<p><strong>pages</strong><br>pagesæ˜¯ä¸€é¡¹ç‰¹æ®Šçš„å·¥ä½œï¼Œç”¨äºå°†é™æ€å†…å®¹ä¸Šä¼ åˆ°GitLabï¼Œå¯ç”¨äºä¸ºæ‚¨çš„ç½‘ç«™æä¾›æœåŠ¡ï¼Œå…¶å®å°±æ˜¯å¯ä»¥æ‰˜ç®¡ä½ çš„ç½‘ç«™ã€‚å®ƒå…·æœ‰ç‰¹æ®Šçš„è¯­æ³•ï¼Œå› æ­¤å¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªè¦æ±‚ï¼š</p>
<p>ä»»ä½•é™æ€å†…å®¹éƒ½å¿…é¡»æ”¾åœ¨public/ç›®å½•ä¸‹ã€‚<br>åˆ¶å“artifactså¿…é¡»æ˜¯ç›®å½•public/,å°±æ˜¯ç¼–è¯‘åçš„æ–‡ä»¶å¿…é¡»å­˜æ”¾åœ¨publicä¸­<br>ä¸‹é¢çš„ç¤ºä¾‹å°†æ‰€æœ‰æ–‡ä»¶ä»é¡¹ç›®çš„æ ¹ç›®å½•ç§»è‡³public/ç›®å½•ã€‚è¿™é‡Œå¿…é¡»å…ˆåˆ›å»ºä¸€ä¸ª.public ç›®å½•ï¼Œé˜²æ­¢æ ¹ç›®å½•ä¸‹å·²ç»å­˜åœ¨publicäº†ï¼Œå¯¼è‡´å¾ªç¯å¤åˆ¶ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pages:</span><br><span class="line">  stage: deploy</span><br><span class="line">  script:</span><br><span class="line">    - mkdir .public</span><br><span class="line">    - cp -r * .public</span><br><span class="line">    - mv .public public</span><br><span class="line">  artifacts:</span><br><span class="line">    paths:</span><br><span class="line">      - public</span><br><span class="line">  only:</span><br><span class="line">    - master</span><br></pre></td></tr></table></figure><br><strong>release</strong><br>releaseå…³é”®è¯æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªreleaseï¼Œå³åˆ›å»ºä¸€ä¸ªå‘å¸ƒï¼Œ<br>åˆ›å»ºä¸€ä¸ªå‘å¸ƒï¼Œå¯ä»¥é…ç½®è¿™äº›å†…å®¹</p>
<ul>
<li>tag_name tag åç§°</li>
<li>description æè¿°</li>
<li>name åç§°</li>
<li>ref æäº¤çš„hashå€¼</li>
<li>milestones è¦å…³è”çš„é‡Œç¨‹ç¢‘</li>
<li>released_at åˆ›å»ºæ—¶é—´<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ios-release:</span><br><span class="line">  script:</span><br><span class="line">    - echo &#39;iOS release job&#39;</span><br><span class="line">  release:</span><br><span class="line">    tag_name: v1.0.0-ios</span><br><span class="line">    description: &#39;iOS release v1.0.0&#39;</span><br></pre></td></tr></table></figure>
<strong>resource_group</strong><br>æœ‰æ—¶åœ¨ç¯å¢ƒä¸­åŒæ—¶è¿è¡Œå¤šä¸ªä½œä¸šæˆ–æµæ°´çº¿æ—¶å¯èƒ½ä¼šå¯¼è‡´åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­å‡ºé”™ã€‚</li>
</ul>
<p>ä¸ºäº†é¿å…è¿™äº›é”™è¯¯ï¼Œresource_groupå¯ä»¥ä½¿ç”¨è¯¥å±æ€§æ¥ç¡®ä¿è¿è¡Œç¨‹åºä¸ä¼šåŒæ—¶è¿è¡ŒæŸäº›ä»»åŠ¡ã€‚èµ„æºç»„çš„è¡Œä¸ºç±»ä¼¼äºå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„ä¿¡å·ç¯ã€‚</p>
<p>å½“ä¸€ä¸ªä»»åŠ¡è®¾ç½®äº†resource_group ï¼Œ åŒä¸€é¡¹ç›®çš„ä¸åŒç®¡é“ä¹‹é—´ä»»åŠ¡çš„è¿è¡Œæ˜¯äº’æ–¥çš„ã€‚å¦‚æœå±äºåŒä¸€èµ„æºç»„çš„å¤šä¸ªä»»åŠ¡åŒæ—¶è¿›å…¥é˜Ÿåˆ—ï¼Œåˆ™è¿è¡Œç¨‹åºä»…é€‰æ‹©å…¶ä¸­ä¸€ä¸ªä½œä¸šã€‚å…¶ä»–ä½œä¸šå°†ç­‰åˆ° resource_groupé‡Šæ”¾ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">deploy-to-production:</span><br><span class="line">  script: deploy</span><br><span class="line">  resource_group: production</span><br></pre></td></tr></table></figure><br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªdeploy-to-productionå•ç‹¬æµæ°´çº¿ä¸­çš„ä¸¤ä¸ªä½œä¸šæ°¸è¿œæ— æ³•åŒæ—¶è¿è¡Œã€‚æœ€åçš„ç»“æœåŠæ—¶ä½ å¯ä»¥ç¡®ä¿æ°¸è¿œä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‘ç”Ÿå¹¶å‘éƒ¨ç½²ã€‚</p>
<p>æ‚¨å¯ä»¥ä¸ºæ¯ä¸ªç¯å¢ƒå®šä¹‰å¤šä¸ªèµ„æºç»„ã€‚ä¾‹å¦‚ï¼Œå½“éƒ¨ç½²åˆ°ç‰©ç†è®¾å¤‡æ—¶ï¼Œæ‚¨å¯èƒ½æœ‰å¤šä¸ªç‰©ç†è®¾å¤‡ã€‚å¯ä»¥å°†æ¯ä¸ªè®¾å¤‡éƒ¨ç½²åˆ°ï¼Œä½†æ˜¯åœ¨ä»»ä½•ç»™å®šæ—¶é—´æ¯ä¸ªè®¾å¤‡åªèƒ½éƒ¨ç½²ä¸€ä¸ªã€‚</p>
<p>resource<em>groupå€¼åªèƒ½åŒ…å«å­—æ¯ï¼Œæ•°å­—ï¼Œ-, </em>, /, $, {, }, .,å’Œç©ºæ ¼ã€‚å®ƒä¸èƒ½ä»¥å¼€å¤´æˆ–ç»“å°¾/ã€‚</p>
<p>retry<br>retryå¯ä»¥è®¾ç½®ä¸€ä¸ªä»»åŠ¡çš„é‡è¯•æ¬¡æ•°ï¼Œå€¼çš„ç±»å‹æ˜¯æ•°å­— æœ€å¤§æ˜¯2ï¼Œå¦‚æœè®¾ç½®2ï¼Œå°±è¡¨æ˜è¯¥ä»»åŠ¡æœ€å¤šå¯ä»¥æ‰§è¡Œ3æ¬¡ï¼Œå…¶ä¸­åŒ…æ‹¬2æ¬¡é‡è¯•ã€‚å¯¹äºç½‘ç»œä¸ç¨³å®šçš„éƒ¨ç½²ï¼Œéå¸¸æœ‰ç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test:</span><br><span class="line">  script: rspec</span><br><span class="line">  retry: 2</span><br></pre></td></tr></table></figure><br><strong>timeout</strong><br>timeoutæ˜¯ç”¨äºè®¾ç½®ä¸€ä¸ªä»»åŠ¡çš„è¶…æ—¶æ—¶é—´ï¼Œ<br>ä½ ä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸ªé¡¹ç›®çº§åˆ«çš„è¶…æ—¶æ—¶é—´ã€‚åœ¨CICDçš„è®¾ç½®ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">build:</span><br><span class="line">  script: build.sh</span><br><span class="line">  timeout: 3 hours 30 minutes</span><br><span class="line"></span><br><span class="line">test:</span><br><span class="line">  script: rspec</span><br><span class="line">  timeout: 3h 30m</span><br></pre></td></tr></table></figure>
<p><strong>variables</strong><br>variableså¯ä»¥è®©ä½ åœ¨yamlæ–‡ä»¶ä¸­å®šä¹‰å˜é‡ï¼Œå˜é‡å¯ä»¥è®¾ç½®å…¨å±€çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä¸ªä»»åŠ¡å†…å®šä¹‰ã€‚ç„¶ååœ¨scriptæˆ–è€…æ‰§è¡Œçš„å‘½ä¸­ä½¿ç”¨,å®šä¹‰å’Œä½¿ç”¨çš„ç¤ºä¾‹,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">variables:</span><br><span class="line">  DEPLOY_SITE: &quot;https:&#x2F;&#x2F;example.com&#x2F;&quot;</span><br><span class="line"></span><br><span class="line">deploy_job:</span><br><span class="line">  stage: deploy</span><br><span class="line">  script:</span><br><span class="line">    - deploy-script --url $DEPLOY_SITE --path &quot;&#x2F;&quot;</span><br><span class="line"></span><br><span class="line">deploy_review_job:</span><br><span class="line">  stage: deploy</span><br><span class="line">  variables:</span><br><span class="line">    REVIEW_PATH: &quot;&#x2F;review&quot;</span><br><span class="line">  script:</span><br><span class="line">    - deploy-review-script --url $DEPLOY_SITE --path $REVIEW_PATH</span><br></pre></td></tr></table></figure></p>

      
      <!-- reward -->
      
      <div id="reward-btn">
        æ‰“èµ
      </div>
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
          
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://ahuii.cn/2021/05/04/Docker-Gitlab-CI-Deploy/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>
      
      

    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="/2021/05/09/Gitlab-CI-%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
        <div class="article-nav-title">
          
            Gitlab CI é¢„å®šä¹‰å˜é‡
          
        </div>
      </a>
    
    
      <a href="/2020/04/01/TensorFlow%E5%85%A5%E9%97%A8/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">Tensorflow Usage</div>
      </a>
    
  </nav>


  

  

  
  
<div class="gitalk" id="gitalk-container"></div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.5.2/dist/gitalk.css">


<script src="https://cdn.jsdelivr.net/npm/gitalk@1.5.2/dist/gitalk.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script>

<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '27f22c9606d2801d92eb',
    clientSecret: '629cbd4c87183101d7d8542013329b0c4fc04534',
    repo: 'AHU-HUI.github.io',
    owner: 'AHU-HUI',
    admin: ['AHU-HUI'],
    // id: location.pathname,      // Ensure uniqueness and length less than 50
    id: md5(location.pathname),
    distractionFreeMode: false,  // Facebook-like distraction free mode
    pagerDirection: 'last'
  })

  gitalk.render('gitalk-container')
</script>

  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2017-2021
        Shine
      </li>
      <li>
        
        Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <span>
  <i>PV:<span id="busuanzi_value_page_pv"></span></i>
  <i>UV:<span id="busuanzi_value_site_uv"></span></i>
</span>
        
      </li>
      
      <li>
        <a href="http://beian.miit.gov.cn/" target="_black">çš–ICPå¤‡17013875å·</a>
      </li>
      
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="to_top">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>
      </div>
    </main>
    <aside class="sidebar">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="HUI&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">æ—…è¡Œ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">æ‘„å½±</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">å…³äºæˆ‘</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>è¯·æˆ‘å–æ¯å’–å•¡å§~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<script src="/js/share.js"></script>



<script src="/fancybox/jquery.fancybox.min.js"></script>




<script>
  try {
    var typed = new Typed("#subtitle", {
    strings: ['é¢æœå¤§æµ·ï¼Œæ˜¥æš–èŠ±å¼€ï¼','æ„¿ä½ ä¸€ç”ŸåŠªåŠ›ï¼Œä¸€ç”Ÿè¢«çˆ±ï¼','æƒ³è¦çš„éƒ½æ‹¥æœ‰ï¼Œå¾—ä¸åˆ°çš„éƒ½é‡Šæ€€ï¼'],
    startDelay: 0,
    typeSpeed: 500,
    loop: true,
    backSpeed: 200,
    showCursor: true
    });
  } catch (err) {
  }
  
</script>




<script src="/js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer:'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
    onClick: (e) => {
      $('.toc-link').removeClass('is-active-link');
      $(`a[href=${e.target.hash}]`).addClass('is-active-link');
      $(e.target.hash).scrollIntoView();
      return false;
    }
  });
</script>


<script>
  var ayerConfig = {
    mathjax: true
  }
</script>


<script src="/js/ayer.js"></script>


<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>



<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

    
  </div>
</body>

</html>